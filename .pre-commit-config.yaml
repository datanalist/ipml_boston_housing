repos:
# =============================================================================
# Общие проверки для всех файлов
# =============================================================================
- repo: https://github.com/pre-commit/pre-commit-hooks
  rev: v5.0.0
  hooks:
    # Проверка trailing whitespace
    - id: trailing-whitespace
      args: [--markdown-linebreak-ext=md]
    # Проверка конца файла (должен быть newline)
    - id: end-of-file-fixer
    # Проверка синтаксиса YAML
    - id: check-yaml
      args: [--unsafe]  # для поддержки docker-compose шаблонов
    # Проверка синтаксиса JSON
    - id: check-json
    # Проверка синтаксиса TOML
    - id: check-toml
    # Проверка больших файлов (>500KB)
    - id: check-added-large-files
      args: ['--maxkb=500']
    # Проверка merge конфликтов
    - id: check-merge-conflict
    # Проверка что executable файлы имеют shebang
    - id: check-executables-have-shebangs
    # Проверка symlinks
    - id: check-symlinks
    # Детекция приватных ключей
    - id: detect-private-key
    # Проверка case conflict в именах файлов
    - id: check-case-conflict
    # Проверка docstring first в Python
    - id: check-docstring-first

# =============================================================================
# Python - Ruff (linter + formatter)
# =============================================================================
- repo: https://github.com/astral-sh/ruff-pre-commit
  rev: v0.14.6
  hooks:
    # Linter
    - id: ruff-check
      types_or: [python, pyi]
      args: [--fix]
    # Formatter
    - id: ruff-format
      types_or: [python, pyi]

# =============================================================================
# YAML - линтинг
# =============================================================================
- repo: https://github.com/adrienverge/yamllint
  rev: v1.37.0
  hooks:
    - id: yamllint
      args: [-c, .yamllint.yaml]
      types: [yaml]

# =============================================================================
# Dockerfile - линтинг
# Примечание: hadolint-docker требует рабочий Docker daemon
# Если Docker недоступен, закомментируйте этот блок
# =============================================================================
# - repo: https://github.com/hadolint/hadolint
#   rev: v2.13.1-beta
#   hooks:
#     - id: hadolint-docker
#       args: [--ignore, DL3008, --ignore, DL3013, --ignore, DL3018, --ignore, DL3059]

# =============================================================================
# Shell scripts - проверка синтаксиса
# =============================================================================
- repo: https://github.com/shellcheck-py/shellcheck-py
  rev: v0.10.0.1
  hooks:
    - id: shellcheck
      args: [--severity=warning]

# =============================================================================
# Secrets detection - поиск случайно закоммиченных секретов
# =============================================================================
- repo: https://github.com/Yelp/detect-secrets
  rev: v1.5.0
  hooks:
    - id: detect-secrets
      args: ['--baseline', '.secrets.baseline']
      exclude: \.lock$|\.dvc$|minio_data/

# =============================================================================
# Git commit messages - проверка формата (Conventional Commits)
# =============================================================================
- repo: https://github.com/commitizen-tools/commitizen
  rev: v4.8.3
  hooks:
    - id: commitizen
      stages: [commit-msg]

# =============================================================================
# DVC - версионирование данных (опционально)
# =============================================================================
# - repo: https://github.com/iterative/dvc
#   rev: 3.56.0
#   hooks:
#     - id: dvc-pre-commit
#       stages: [pre-commit]
#     - id: dvc-pre-push
#       stages: [pre-push]
